<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>MINTVERSE</title>
	<meta property="og:image" content="../cover.png"/>

	<link href="https://cdn.jsdelivr.net/npm/taipei-sans-tc" rel="stylesheet" />
	<link
	  href="https://cdn.jsdelivr.net/npm/taipei-sans-tc/dist/Light/TaipeiSansTCBeta-Light.css"
	  rel="stylesheet"
	/>
	<link
	  href="https://cdn.jsdelivr.net/npm/taipei-sans-tc/dist/Bold/TaipeiSansTCBeta-Bold.css"
	  rel="stylesheet"
	/>

	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;600&family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="../css/_reset.css">
	<link rel="stylesheet" href="../css/header.css">
	<link rel="stylesheet" href="../css/footer.css">
	<link rel="stylesheet" href="../css/found.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.1/p5.min.js"></script>
	<script src="../js/jquery-3.6.0.min.js"></script>
	<script  src="../js/found/marquee.js"></script>
	<script  src="../js/found/lightBlink.js"></script>
	<script  src="../js/found/gradien.js"></script>
	<script  src="../js/found/timer.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/jquery.marquee@1.6.0/jquery.marquee.min.js"></script>
	<script src="../js/found/sprite.js"></script>
	<script src="../js/found/index.js"></script>
	<script src="../js/found/dead.js"></script>
	<script src="../js/found/notedit.js"></script>
	<script src="../js/header.js"></script>
	<script src="../js/footer.js"></script>
</head>
<body>
	<div id="app">
		<header>
		</header>
		<section class="intro" style="display:none;">
			<h1>
				歡迎加入<br>《第二宇宙辭典》<br>鑄造小組
			</h1>
			<p>在這「文字」已然死滅的時代，你能夠讀懂這串訊息，就代表你有資格加入我們。</p>
			<p>進入我們的鑄造系統後，你會獲得一個隨機分配的詞彙。那個詞彙，就是你要負責鑄造的詞條。詞條的鑄造原則如下：</p>
			<ul>
				<li>請盡量用精要的字數（10 - 100 字），容納最多的意義。</li>
				<li>面對每一詞彙，請先判斷它的「詞性」，再來編寫「意義」。</li>
				<li>這些詞彙的確切意義，已經隨著舊人類文明一同消逝了。因此，你沒有任何正確答案可以遵循，只能依靠你的直覺與想像——我們相信，像你這樣特別的人，基因裡必然銘刻了部分的線索。請相信你自己的答案。</li>
				<li>我們唯一確定的是：<span>「這些詞彙的意義，與現世人們的普遍理解絕對不同。」</span></li>
				<li>詞彙是有壽命的，請在它耗盡自己的時間以前，盡快完成鑄造。</li>
				<li>如果你尚無靈感，可以參考鑄造小組的示範註釋。</li>
			</ul>
			<p>這些詞彙，是由「第二宇宙辭典」鑄造小組，從舊文明考古遺中，挖掘出來的斷簡殘篇。我們目前不知道這些斷簡殘篇的意義和全貌。但如果有足夠多的人，進行了詞彙的鑄造——</p>
			<p>也許，我們就能「贖回」那個可能存在的「第二宇宙」</p>
			<label class="check">我已閱讀並同意參與條款
			  <input type="checkbox" checked="checked">
			  <span class="checkmark"></span>
			</label>
			<button>確認加入</button>
		</section>
		<section class="edit">
			<h1>唯一鑄造的原則是：「這些詞彙的意義，與現世人們的普遍理解絕對不同。」</h1>
			<div id="empty" class="canvasWrap">
				<img src="../image/logo.svg" alt="">
			</div>
			<div id="myCanvas" class="canvasWrap" style="display:none;">
			</div>
			<div id="noedit" style="display:none;" class ="canvasWrap" >
				<div class="info">
					<h6>MINTVERSE DICTIONARY</h6>
					<div class="token">
						<label>TOKEN ID</label>
						<p class="id">0023</p>
					</div>
					<div class="countdown">
						<label for="">DEADLINE</label>
						<p></p>
					</div>
					<ul>
						<li>第二宇宙辭典</li>
						<li>宇宙飛船</li>
						<li>作者 朱宥勳</li>
					</ul>
				</div>
			</div>
			<div class="formContainer">
				<h4>錢包：<span>0x000000000000000000000</span></h4>
				<div class="select">
					<select name="" id="selectToken">
						    <option value="">選擇你所擁有的詞彙 Token ID</option>
					</select>
				</div>
				<div class="rule">
					<p class="rule">進入我們的鑄造系統後，你會獲得一個隨機分配的詞彙。那個詞彙，就是你要負責鑄造的詞條。詞條的鑄造原則如下：</p>
					<ul class="rule">
						<li>請盡量用精要的字數（10 - 100 字），容納最多的意義。</li>
						<li>面對每一詞彙，請先判斷它的「詞性」，再來編寫「意義」。</li>
						<li>這些詞彙的確切意義，已經隨著舊人類文明一同消逝了。因此，你沒有任何正確答案可以遵循，只能依靠你的直覺與想像——我們相信，像你這樣特別的人，基因裡必然銘刻了部分的線索。請相信你自己的答案。</li>
						<li>我們唯一確定的是：「這些詞彙的意義，與現世人們的普遍理解絕對不同。」</li>
						<li>詞彙是有壽命的，請在它耗盡自己的時間以前，盡快完成鑄造。</li>
						<li>如果你尚無靈感，可以參考鑄造小組的示範註釋。</li>
					</ul>
					<p class="rule">這些詞彙，是由「第二宇宙辭典」鑄造小組，從舊文明考古遺中，挖掘出來的斷簡殘篇。我們目前不知道這些斷簡殘篇的意義和全貌。但如果有足夠多的人，進行了詞彙的鑄造——</p>
					<p class="rule">也許，我們就能「贖回」那個可能存在的「第二宇宙」。</p>	
				</div>
				<div class="form" style="display: none">
					<p class="deadline">DEADLINE <span>00:00:00</span><br>時限內沒有完成鑄造，詞彙將會永久死亡。</p>
					<div class="inputWrap editForm">
						<label for="">鑄造者 (填寫1-10個中文字)</label>
						<input type="text" id="author">
					</div>
					<div class="selectWrap editForm">
						<label for="">詞性</label>
						<div class="select">
							<select name="" id="speech">
								<option value="">詞性</option>
								<option value="1">名詞</option>
								<option value="2">動詞</option>
								<option value="3">副詞</option>
								<option value="4">形容詞</option>
								<option value="5">介系詞</option>
								<option value="6">狀聲詞</option>
								<option value="7">代名詞</option>
								<option value="8">連結詞</option>
								<option value="9">感嘆詞</option>
							</select>
						</div>
						<div class="select">
							<select name="" id="speech1">
								<option value="">詞性</option>
							</select>
						</div>
					</div>
					<div class="inputWrap synonym editForm">
						<label for="">同義詞 (填寫1-4個，總字數不超過10個中文字)</label>
						<input type="text" id="synonym0">
						<input type="text" id="synonym1">
						<input type="text" id="synonym2">
						<input type="text" id="synonym3">
					</div>
					<div class="inputWrap editForm">
						<label for="textarea">註釋 (填寫 10-100 個中文字)</label>
						<textarea name="" id="textarea" rows="6"></textarea>
						<ul><li>如果你尚無靈感，可以參考鑄造小組的示範註釋。</li></ul>
					</div>
				</div>
				<div class="dead" style="display:none;">
					<p>一段話一段話一段話一段話一段話一段話一段話一段話一段話一段話一段話一段話一段話一段話一段話一段話一段話一段話一段話一段話一段話一段話一段話一段話一段話</p>
				</div>
			</div>
			<button class="disable">開始鑄造</button>
		</section>
		<footer>
			
		</footer>
	</div>
	<script>
		$(document).ready(function() {
			let deadP5, nftP5, noteditP5;
			let status = 0;
			$('header').setHeader();
			$('footer').setFooter();
			//nft();
			//renderDead();
			//notedit();
			let wallet_info = {
				address:'0x000000000000000000000',
				nftIdList:[
					{	
						token:'0',
					},
					{
						token:'1',
					},
					{
						token:'2',
					},
					{
						token:'3',
					}
				]
			}
			let nftDetail = {};
			wallet_info.nftIdList.forEach( function(item, index) {
				// statements
				$("#selectToken").append($("<option></option>").attr("value", item.token).text(item.token));
			});
			$('.intro button').on('click', function(event) {
				event.preventDefault();
				/* Act on the event */
				$('.intro').hide();
				$('.edit').show();
			});
			$('#selectToken').on('change', async function() {
				
			  	if(this.value == '' || this.value == wallet_info.nftIdList.token) {
			  		changeView('empty')
			  		return
			  	}		
			  	const endpoint = `http://54.248.1.203:8080/api/mintverse/token/${this.value}`;
			  	let data = await $.ajax({
			  		type: "GET",
				    url: endpoint,
				    dataType: "json",
				    success: function (response) {
				    	nftDetail = response.token;
				      	console.log(nftDetail)
				      	changeView(nftDetail.status);
				    },
				    error: function (thrownError) {
				      	console.log(thrownError);
				    }
			  	})
			  	//let valueIdx = $("#selectToken")[0].selectedIndex - 1;
			});
			$('#speech').on('change', function(event) {
				let selectIndex = $("#speech").find(":selected").index();
				$('#speech1').empty();
				$('#speech1').append($("<option></option>").attr("value", "").text("詞性"));
				if(selectIndex == 0)return;
				$('#speech option').each(function(index){
					if(index == selectIndex || index == 0)return;
					$('#speech1').append($("<option></option>").attr("value", $(this).val()).text($(this).text()));
				})
			})
			function changeView(status){
				console.log(nftDetail)
				$('.canvasWrap').hide();
				// "0:尚未被Mint, 1: 尚未開始寫作, 2: 開始寫作"
				removeCanvas();
				$('.edit .rule').hide();
				$('.edit .form').hide();
				$('.edit .dead').hide();
				$('.edit #myCanvas').hide();
				$('canvas').remove();
				$('.edit #notedit').hide();
				switch (status) {
					case 'empty':
						$('.edit .rule').show();
						$('.edit #empty').show();
						$('.edit button').addClass('disable');
						break;
					case 0:
						$('.edit #empty').show();
						break;
					case 1:
						if(nftDetail.current_time <= nftDetail.expire_time){
							$('.edit .form').show();
							$('.edit button').show();
							setCountdown(nftDetail.current_time * 1000, nftDetail.expire_time * 1000);
							$('#noedit').show();
							$('#noedit .info .id').text(nftDetail.id);
							$('#noedit .info ul li:nth-of-type(2)').text(nftDetail.article_title);
							$('#noedit .info ul li:nth-of-type(3)').text('作家 ' + nftDetail.author);
							$('.editForm').hide();
							$('.edit button.disable').removeClass('disable');
							noteditP5 = notedit(nftDetail.word.word);
						} else {
							$('.edit #myCanvas').show();
							$('.dead').show();
							deadP5 = renderDead(nftDetail.word.word);
						}
						break;
					case 2:
						$('.edit button').show();
						$('.edit .form').show();
						$('.edit #myCanvas').show();
						$('.edit button').removeClass('disable').text('MINT 鑄造定義');
						nftP5 = nft(nftDetail);
						break;
					default:
						// statements_def
						break;
				}
			}
			function removeCanvas(){
				if(nftP5 != undefined)nftP5.remove();
				if(deadP5 != undefined)deadP5.remove();
				if(noteditP5 != undefined)noteditP5.remove();		
				delete nftP5;
				delete deadP5;
				delete noteditP5;
			}
			function setCountdown(start,end){
				var countDownDate = new Date(end).getTime();

				// Update the count down every 1 second
				var x = setInterval(function() {

				  // Get today's date and time
				  var now = new Date().getTime();

				  // Find the distance between now and the count down date
				  var distance = countDownDate - now;

				  // Time calculations for days, hours, minutes and seconds
				  var days = Math.floor(distance / (1000 * 60 * 60 * 24));
				  var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
				  var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
				  var seconds = Math.floor((distance % (1000 * 60)) / 1000);

				  // Display the result in the element with id="demo"
				  if(hours < 10)hours = "0" + hours.toString();
				  if(minutes < 10)minutes = "0" + minutes.toString();
				  if(seconds < 10)seconds = "0" + seconds.toString();
				  $('.countdown p').text(hours + " : "
				  + minutes + " : " + seconds);
				  $('.deadline span').text(hours + " : "
				  + minutes + " : " + seconds);
				  // If the count down is finished, write some text
				  if (distance < 0) {
				    clearInterval(x);
				    $('.countdown p').text("Time Out");
				  }
				}, 1000);
			}

		})
	</script>
</body>
</html>